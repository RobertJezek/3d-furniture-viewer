<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Pl√°novaƒç Interi√©ru</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: #333;
            text-align: center;
            font-size: 28px;
            margin-bottom: 5px;
        }
        
        .header p {
            color: #666;
            text-align: center;
            font-size: 14px;
        }
        
        .container {
            flex: 1;
            display: flex;
            padding: 20px;
            gap: 20px;
            max-width: 1800px;
            margin: 0 auto;
            width: 100%;
        }
        
        .sidebar {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            width: 350px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            max-height: calc(100vh - 160px);
            overflow-y: auto;
        }
        
        .sidebar h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .section {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .section h3 {
            color: #555;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .input-group {
            margin-bottom: 10px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-size: 12px;
            font-weight: 600;
        }
        
        .input-group input,
        .input-group select {
            width: 100%;
            padding: 8px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 13px;
        }
        
        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
        }
        
        button {
            width: 100%;
            padding: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: transform 0.2s;
            margin-top: 8px;
        }
        
        button:hover {
            transform: translateY(-2px);
        }
        
        button.danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }
        
        .furniture-list {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .furniture-item {
            background: white;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            cursor: pointer;
        }
        
        .furniture-item:hover {
            border-color: #667eea;
        }
        
        .furniture-item.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }
        
        .furniture-item-title {
            font-weight: 600;
            color: #333;
            font-size: 13px;
            margin-bottom: 3px;
        }
        
        .furniture-item-info {
            font-size: 11px;
            color: #666;
        }
        
        .viewer-container {
            flex: 1;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        
        #canvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        .toolbar {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            gap: 8px;
        }
        
        .toolbar button {
            width: auto;
            padding: 8px 12px;
            margin: 0;
            font-size: 12px;
        }
        
        .info-panel {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 12px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            font-size: 11px;
            max-width: 250px;
        }
        
        .info-panel h4 {
            margin-bottom: 8px;
            color: #333;
            font-size: 12px;
            font-weight: 600;
        }
        
        .info-panel p {
            margin: 3px 0;
            color: #666;
        }
        
        .controls-widget {
            position: absolute;
            top: 80px;
            left: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.2);
            display: none;
            min-width: 200px;
        }
        
        .controls-widget.active {
            display: block;
        }
        
        .controls-widget h4 {
            margin-bottom: 10px;
            color: #333;
            font-size: 13px;
        }
        
        .control-row {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
        }
        
        .control-row button {
            flex: 1;
            padding: 8px;
            margin: 0;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üè† 3D Pl√°novaƒç Interi√©ru</h1>
        <p>T√°hnƒõte n√°bytek my≈°√≠ po m√≠stnosti!</p>
    </div>
    
    <div class="container">
        <div class="sidebar">
            <h2>üè† M√≠stnost</h2>
            <div class="section">
                <h3>üìè Rozmƒõry (cm)</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>D√©lka:</label>
                        <input type="number" id="roomLength" value="500" min="200" max="1500">
                    </div>
                    <div class="input-group">
                        <label>≈†√≠≈ôka:</label>
                        <input type="number" id="roomWidth" value="400" min="200" max="1500">
                    </div>
                    <div class="input-group">
                        <label>V√Ω≈°ka:</label>
                        <input type="number" id="roomHeight" value="270" min="200" max="500">
                    </div>
                </div>
                <button id="updateRoomBtn">üîÑ Aktualizovat</button>
            </div>
            
            <h2>ü™ë P≈ôidat N√°bytek</h2>
            <div class="section">
                <div class="input-group">
                    <label>Typ:</label>
                    <select id="furnitureType">
                        <option value="cabinet">Sk≈ô√≠≈à</option>
                        <option value="table">St≈Øl</option>
                        <option value="shelf">Police</option>
                        <option value="drawer">Komoda</option>
                    </select>
                </div>
                
                <h3>üìè Rozmƒõry (cm)</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>≈†:</label>
                        <input type="number" id="furnitureWidth" value="100" min="10" max="500">
                    </div>
                    <div class="input-group">
                        <label>V:</label>
                        <input type="number" id="furnitureHeight" value="200" min="10" max="500">
                    </div>
                    <div class="input-group">
                        <label>H:</label>
                        <input type="number" id="furnitureDepth" value="60" min="10" max="500">
                    </div>
                </div>
                
                <button id="addFurnitureBtn">‚ûï P≈ôidat</button>
            </div>
            
            <h2>üìã Seznam n√°bytku</h2>
            <div class="furniture-list" id="furnitureList">
                <p style="text-align: center; color: #999; padding: 15px; font-size: 12px;">Zat√≠m ≈æ√°dn√Ω n√°bytek</p>
            </div>
        </div>
        
        <div class="viewer-container">
            <canvas id="canvas"></canvas>
            
            <div class="toolbar">
                <button id="viewTopBtn">üìê Shora</button>
                <button id="view3DBtn">üîÑ 3D</button>
                <button id="resetViewBtn">‚Ü∫ Reset</button>
            </div>
            
            <div class="controls-widget" id="controlsWidget">
                <h4>Ovl√°d√°n√≠ n√°bytku</h4>
                <div class="control-row">
                    <button id="moveUpBtn">‚¨ÜÔ∏è</button>
                    <button id="rotateBtn">üîÑ</button>
                    <button id="moveDownBtn">‚¨áÔ∏è</button>
                </div>
                <div class="input-group">
                    <label>V√Ω≈°ka: <span id="heightValue">0</span> cm</label>
                    <input type="range" id="heightSlider" min="0" max="250" value="0" step="5">
                </div>
                <button id="deleteBtn" class="danger">üóëÔ∏è Smazat</button>
            </div>
            
            <div class="info-panel">
                <h4>üí° Ovl√°d√°n√≠:</h4>
                <p><strong>Kamera:</strong></p>
                <p>‚Ä¢ Lev√© tlaƒç√≠tko: Ot√°ƒçen√≠</p>
                <p>‚Ä¢ Prav√© tlaƒç√≠tko: Posun</p>
                <p>‚Ä¢ Koleƒçko: Zoom</p>
                <p style="margin-top: 8px;"><strong>N√°bytek:</strong></p>
                <p>‚Ä¢ Kliknƒõte a t√°hnƒõte my≈°√≠</p>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let scene, camera, renderer, room, raycaster, mouse;
        let furnitureItems = [];
        let selectedFurniture = null;
        let furnitureCounter = 0;
        let isDraggingFurniture = false;
        let isDraggingCamera = false;
        let isRightClick = false;
        
        const typeNames = {
            'cabinet': 'Sk≈ô√≠≈à',
            'table': 'St≈Øl',
            'shelf': 'Police',
            'drawer': 'Komoda'
        };
        
        function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0xe8f4f8);
            
            const canvas = document.getElementById('canvas');
            camera = new THREE.PerspectiveCamera(60, canvas.clientWidth / canvas.clientHeight, 0.1, 3000);
            camera.position.set(400, 400, 400);
            camera.lookAt(0, 0, 0);
            
            renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
            renderer.setSize(canvas.clientWidth, canvas.clientHeight);
            renderer.shadowMap.enabled = true;
            
            raycaster = new THREE.Raycaster();
            mouse = new THREE.Vector2();
            
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(300, 400, 300);
            directionalLight.castShadow = true;
            scene.add(directionalLight);
            
            createRoom();
            setupEventListeners();
            
            window.addEventListener('resize', onWindowResize);
            
            animate();
        }
        
        function createRoom() {
            if (room) scene.remove(room);
            
            const length = parseFloat(document.getElementById('roomLength').value);
            const width = parseFloat(document.getElementById('roomWidth').value);
            const height = parseFloat(document.getElementById('roomHeight').value);
            
            room = new THREE.Group();
            
            const floorGeometry = new THREE.PlaneGeometry(length, width);
            const floorMaterial = new THREE.MeshStandardMaterial({ 
                color: 0xD2B48C,
                roughness: 0.8
            });
            const floor = new THREE.Mesh(floorGeometry, floorMaterial);
            floor.rotation.x = -Math.PI / 2;
            floor.receiveShadow = true;
            floor.userData.isFloor = true;
            room.add(floor);
            
            const gridHelper = new THREE.GridHelper(Math.max(length, width), 20, 0x888888, 0xcccccc);
            room.add(gridHelper);
            
            const wallMaterial = new THREE.MeshStandardMaterial({ 
                color: 0xf5f5f5,
                side: THREE.DoubleSide,
                transparent: true,
                opacity: 0.4
            });
            
            const backWall = new THREE.Mesh(
                new THREE.PlaneGeometry(length, height),
                wallMaterial
            );
            backWall.position.set(0, height/2, -width/2);
            room.add(backWall);
            
            const leftWall = new THREE.Mesh(
                new THREE.PlaneGeometry(width, height),
                wallMaterial
            );
            leftWall.position.set(-length/2, height/2, 0);
            leftWall.rotation.y = Math.PI / 2;
            room.add(leftWall);
            
            const rightWall = new THREE.Mesh(
                new THREE.PlaneGeometry(width, height),
                wallMaterial
            );
            rightWall.position.set(length/2, height/2, 0);
            rightWall.rotation.y = -Math.PI / 2;
            room.add(rightWall);
            
            scene.add(room);
        }
        
        function createFurnitureObject(type, w, h, d) {
            const furniture = new THREE.Group();
            furniture.userData.type = type;
            furniture.userData.width = w;
            furniture.userData.height = h;
            furniture.userData.depth = d;
            furniture.userData.isFurniture = true;
            furniture.userData.heightOffset = 0;
            
            const material = new THREE.MeshStandardMaterial({ 
                color: 0x8B4513,
                roughness: 0.7
            });
            
            if (type === 'cabinet') {
                const body = new THREE.Mesh(new THREE.BoxGeometry(w, h, d), material);
                body.position.y = h/2;
                body.castShadow = true;
                body.userData.pickable = true;
                furniture.add(body);
                
                const doorMaterial = new THREE.MeshStandardMaterial({ color: 0x8B4513, roughness: 0.6 });
                const doorWidth = w/2 - 2;
                const doorHeight = h - 4;
                
                const leftDoor = new THREE.Mesh(new THREE.BoxGeometry(doorWidth, doorHeight, 1), doorMaterial);
                leftDoor.position.set(-w/4, h/2, d/2 + 0.6);
                leftDoor.castShadow = true;
                leftDoor.userData.pickable = true;
                furniture.add(leftDoor);
                
                const rightDoor = new THREE.Mesh(new THREE.BoxGeometry(doorWidth, doorHeight, 1), doorMaterial);
                rightDoor.position.set(w/4, h/2, d/2 + 0.6);
                rightDoor.castShadow = true;
                rightDoor.userData.pickable = true;
                furniture.add(rightDoor);
                
            } else if (type === 'table') {
                const top = new THREE.Mesh(new THREE.BoxGeometry(w, 3, d), material);
                top.position.y = h;
                top.castShadow = true;
                top.userData.pickable = true;
                furniture.add(top);
                
                const legThickness = 5;
                const legHeight = h - 1.5;
                const legPositions = [
                    [-w/2 + legThickness, legHeight/2, -d/2 + legThickness],
                    [w/2 - legThickness, legHeight/2, -d/2 + legThickness],
                    [-w/2 + legThickness, legHeight/2, d/2 - legThickness],
                    [w/2 - legThickness, legHeight/2, d/2 - legThickness]
                ];
                
                legPositions.forEach(pos => {
                    const leg = new THREE.Mesh(new THREE.BoxGeometry(legThickness, legHeight, legThickness), material);
                    leg.position.set(...pos);
                    leg.castShadow = true;
                    leg.userData.pickable = true;
                    furniture.add(leg);
                });
                
            } else if (type === 'shelf') {
                const sideThickness = 2;
                const leftSide = new THREE.Mesh(new THREE.BoxGeometry(sideThickness, h, d), material);
                leftSide.position.set(-w/2 + sideThickness/2, h/2, 0);
                leftSide.castShadow = true;
                leftSide.userData.pickable = true;
                furniture.add(leftSide);
                
                const rightSide = leftSide.clone();
                rightSide.position.x = w/2 - sideThickness/2;
                rightSide.userData.pickable = true;
                furniture.add(rightSide);
                
                const shelfCount = Math.floor(h / 40);
                const shelfThickness = 2;
                
                for (let i = 0; i <= shelfCount; i++) {
                    const shelf = new THREE.Mesh(new THREE.BoxGeometry(w - sideThickness*2, shelfThickness, d), material);
                    shelf.position.y = (h / shelfCount) * i;
                    shelf.castShadow = true;
                    shelf.userData.pickable = true;
                    furniture.add(shelf);
                }
                
            } else if (type === 'drawer') {
                const body = new THREE.Mesh(new THREE.BoxGeometry(w, h, d), material);
                body.position.y = h/2;
                body.castShadow = true;
                body.userData.pickable = true;
                furniture.add(body);
                
                const drawerCount = Math.floor(h / 30);
                const drawerHeight = (h / drawerCount) - 2;
                
                for (let i = 0; i < drawerCount; i++) {
                    const drawer = new THREE.Mesh(new THREE.BoxGeometry(w - 4, drawerHeight, 1), material);
                    drawer.position.set(0, (h/drawerCount) * i + drawerHeight/2 + 1, d/2 + 0.6);
                    drawer.castShadow = true;
                    drawer.userData.pickable = true;
                    furniture.add(drawer);
                }
            }
            
            return furniture;
        }
        
        function addFurniture() {
            const type = document.getElementById('furnitureType').value;
            const w = parseFloat(document.getElementById('furnitureWidth').value);
            const h = parseFloat(document.getElementById('furnitureHeight').value);
            const d = parseFloat(document.getElementById('furnitureDepth').value);
            
            const furniture = createFurnitureObject(type, w, h, d);
            furniture.userData.id = furnitureCounter++;
            
            scene.add(furniture);
            furnitureItems.push(furniture);
            
            updateFurnitureList();
        }
        
        function updateFurnitureList() {
            const list = document.getElementById('furnitureList');
            
            if (furnitureItems.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #999; padding: 15px; font-size: 12px;">Zat√≠m ≈æ√°dn√Ω n√°bytek</p>';
                return;
            }
            
            list.innerHTML = furnitureItems.map((item, index) => `
                <div class="furniture-item ${selectedFurniture === item ? 'selected' : ''}" onclick="selectFurnitureByIndex(${index})">
                    <div class="furniture-item-title">${typeNames[item.userData.type]} #${item.userData.id + 1}</div>
                    <div class="furniture-item-info">${item.userData.width}√ó${item.userData.height}√ó${item.userData.depth} cm</div>
                </div>
            `).join('');
        }
        
        function selectFurnitureByIndex(index) {
            selectFurniture(furnitureItems[index]);
        }
        
        function selectFurniture(furniture) {
            if (selectedFurniture) {
                selectedFurniture.traverse(child => {
                    if (child.isMesh && child.material) {
                        child.material.emissive = new THREE.Color(0x000000);
                    }
                });
            }
            
            selectedFurniture = furniture;
            
            selectedFurniture.traverse(child => {
                if (child.isMesh && child.material) {
                    child.material.emissive = new THREE.Color(0x4444ff);
                    child.material.emissiveIntensity = 0.2;
                }
            });
            
            document.getElementById('controlsWidget').classList.add('active');
            const heightSlider = document.getElementById('heightSlider');
            heightSlider.value = selectedFurniture.userData.heightOffset || 0;
            document.getElementById('heightValue').textContent = heightSlider.value;
            
            updateFurnitureList();
        }
        
        function deselectFurniture() {
            if (selectedFurniture) {
                selectedFurniture.traverse(child => {
                    if (child.isMesh && child.material) {
                        child.material.emissive = new THREE.Color(0x000000);
                    }
                });
                selectedFurniture = null;
            }
            document.getElementById('controlsWidget').classList.remove('active');
            updateFurnitureList();
        }
        
        function deleteFurniture() {
            if (!selectedFurniture) return;
            
            const index = furnitureItems.indexOf(selectedFurniture);
            if (index > -1) {
                scene.remove(furnitureItems[index]);
                furnitureItems.splice(index, 1);
                deselectFurniture();
                updateFurnitureList();
            }
        }
        
        function setupEventListeners() {
            const canvas = document.getElementById('canvas');
            let previousMousePosition = { x: 0, y: 0 };
            
            canvas.addEventListener('mousedown', (e) => {
                const rect = canvas.getBoundingClientRect();
                mouse.x = ((e.clientX - rect.left) / rect.width) * 2 - 1;
                mouse.y = -((e.clientY - rect.top) / rect.height) * 2 + 1;
                
                raycaster.setFromCamera(mouse, camera);
                
                const furnitureObjects = [];
                furnitureItems.forEach(item => {
                    item.traverse(child => {
                        if (child.isMesh && child.userData.pickable) {
                            furnitureObjects.push(child);
                        }
                    });
                });
                
                const intersects = raycaster.intersectObjects(furnitureObjects);
                
                if (intersects.length > 0 && e.button === 0) {
                    let furniture = intersects[0].object;
                    while (furniture.parent && !furniture.userData.isFurniture) {
                        furniture = furniture.parent;
                    }
                    
                    if (furniture.userData.isFurniture) {
                        selectFurniture(furniture);
                        isDraggingFurniture = true;
                        return;
                    }
                }
                
                isDraggingCamera = true;
                isRightClick = e.button === 2;
                previousMousePosition = { x: e.clientX, y: e.clientY };
                
                if (e.button === 0 && intersects.length === 0) {
                    deselectFurniture();
                }
            });
            
            canvas.addEventListener('mousemove', (e) => {
                if (isDraggingFurniture && selectedFurniture) {
                    const rect = canvas.getBoundingClientRect();
                    mouse.x = ((e.clientX - rect.left) / rect.width) * 2 - 1;
                    mouse.y = -((e.clientY - rect.top) / rect.height) * 2 + 1;
                    
                    raycaster.setFromCamera(mouse, camera);
                    
                    const floorObjects = [];
                    room.traverse(child => {
                        if (child.userData.isFloor) {
                            floorObjects.push(child);
                        }
                    });
                    
                    const intersects = raycaster.intersectObjects(floorObjects);
                    
                    if (intersects.length > 0) {
                        selectedFurniture.position.x = intersects[0].point.x;
                        selectedFurniture.position.z = intersects[0].point.z;
                        selectedFurniture.position.y = selectedFurniture.userData.heightOffset || 0;
                    }
                } else if (isDraggingCamera) {
                    const deltaX = e.clientX - previousMousePosition.x;
                    const deltaY = e.clientY - previousMousePosition.y;
                    
                    if (isRightClick) {
                        camera.position.x -= deltaX * 0.5;
                        camera.position.y += deltaY * 0.5;
                    } else {
                        const radius = Math.sqrt(camera.position.x ** 2 + camera.position.z ** 2);
                        const angle = Math.atan2(camera.position.z, camera.position.x);
                        const newAngle = angle - deltaX * 0.01;
                        
                        camera.position.x = radius * Math.cos(newAngle);
                        camera.position.z = radius * Math.sin(newAngle);
                        camera.position.y += deltaY * 0.5;
                        
                        camera.lookAt(0, 100, 0);
                    }
                    
                    previousMousePosition = { x: e.clientX, y: e.clientY };
                }
            });
            
            canvas.addEventListener('mouseup', () => {
                isDraggingFurniture = false;
                isDraggingCamera = false;
            });
            
            canvas.addEventListener('wheel', (e) => {
                e.preventDefault();
                const zoomSpeed = 10;
                const direction = new THREE.Vector3();
                camera.getWorldDirection(direction);
                camera.position.addScaledVector(direction, e.deltaY > 0 ? -zoomSpeed : zoomSpeed);
            });
            
            canvas.addEventListener('contextmenu', (e) => e.preventDefault());
            
            document.getElementById('updateRoomBtn').addEventListener('click', createRoom);
            document.getElementById('addFurnitureBtn').addEventListener('click', addFurniture);
            
            document.getElementById('viewTopBtn').addEventListener('click', () => {
                camera.position.set(0, 600, 0);
                camera.lookAt(0, 0, 0);
            });
            
            document.getElementById('view3DBtn').addEventListener('click', () => {
                camera.position.set(400, 400, 400);
                camera.lookAt(0, 0, 0);
            });
            
            document.getElementById('resetViewBtn').addEventListener('click', () => {
                camera.position.set(400, 400, 400);
                camera.lookAt(0, 0, 0);
            });
            
            document.getElementById('moveUpBtn').addEventListener('click', () => {
                if (selectedFurniture) {
                    selectedFurniture.userData.heightOffset = (selectedFurniture.userData.heightOffset || 0) + 10;
                    selectedFurniture.position.y = selectedFurniture.userData.heightOffset;
                    document.getElementById('heightSlider').value = selectedFurniture.userData.heightOffset;
                    document.getElementById('heightValue').textContent = selectedFurniture.userData.heightOffset;
                }
            });
            
            document.getElementById('moveDownBtn').addEventListener('click', () => {
                if (selectedFurniture) {
                    selectedFurniture.userData.heightOffset = Math.max(0, (selectedFurniture.userData.heightOffset || 0) - 10);
                    selectedFurniture.position.y = selectedFurniture.userData.heightOffset;
                    document.getElementById('heightSlider').value = selectedFurniture.userData.heightOffset;
                    document.getElementById('heightValue').textContent = selectedFurniture.userData.heightOffset;
                }
            });
            
            document.getElementById('rotateBtn').addEventListener('click', () => {
                if (selectedFurniture) {
                    selectedFurniture.rotation.y += Math.PI / 2;
                }
            });
            
            document.getElementById('heightSlider').addEventListener('input', (e) => {
                if (selectedFurniture) {
                    selectedFurniture.userData.heightOffset = parseFloat(e.target.value);
                    selectedFurniture.position.y = selectedFurniture.userData.heightOffset;
                    document.getElementById('heightValue').textContent = e.target.value;
                }
            });
            
            document.getElementById('deleteBtn').addEventListener('click', deleteFurniture);
        }
        
        function onWindowResize() {
            const canvas = renderer.domElement;
            camera.aspect = canvas.clientWidth / canvas.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(canvas.clientWidth, canvas.clientHeight);
        }
        
        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }
        
        window.selectFurnitureByIndex = selectFurnitureByIndex;
        
        init();
    </script>
</body>
</html>